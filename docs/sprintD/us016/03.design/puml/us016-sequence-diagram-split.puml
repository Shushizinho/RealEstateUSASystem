@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

title As an Agent, I want to list real estate purchase orders to accept or decline a purchase order for a property

autonumber

actor "Agent" as AGT
participant "RespondVisitRequestUI" as UI
participant ":VisitRequestController" as CTRL
'participant ":Repositories" as RepositorySingleton
'participant "repositories\n:Repositories" as PLAT
'participant "visitRequestRepository\n:VisitRequestRepository" as REP



activate AGT

    AGT -> UI : asks to respond to the visit request
    activate UI

    UI ->CTRL**: create()
     UI -> CTRL : getVisitRequests()

     activate CTRL

     ref over CTRL

     get visit requests

     end ref



      CTRL --> UI : provide list of visit requests
     deactivate CTRL



    UI --> AGT : provide list of visit requests
    deactivate UI


    group loop
    AGT -> UI : selectes request
    activate UI

        UI -> UI : selectRequest()
        activate UI

        UI->UI : ValidateInput()
        deactivate UI


    UI--> AGT : asks what message wants to write
    deactivate UI
    end

    group loop
    AGT -> UI : submit answer
    activate UI

        UI -> UI : submitAnswer()
        activate UI

        UI->UI : ValidateAnswer()
        deactivate UI

        end

        UI -> CTRL : createEmail(String sender, String receiver, String subject, String message)

        activate CTRL

        ref over CTRL
        create email

        end ref


        CTRL --> UI : message
        deactivate CTRL
    UI --> AGT: displays operation success and send email to client
    deactivate UI

deactivate AGT

@enduml